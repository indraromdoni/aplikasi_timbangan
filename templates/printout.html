<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Print Hasil Timbang</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    @page { size: A5; margin: 10mm; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .header { text-align:center; font-weight:700; margin-bottom:8px; }
    .small { font-size:11px; color:#333; }
  </style>
</head>
<body>
  <div class="header">Hasil Timbang</div>
  <table>
    <tr>
      <td><strong>Tanggal</strong></td>
      <td><strong>:</strong></td>
      <td><div id="tanggal"></div></td>
      <td>&nbsp;&nbsp;&nbsp;</td>
      <td><strong>Nopol</strong></td>
      <td><strong>:</strong></td>
      <td><div id="nopol"></div></td>
    </tr>
    <tr>
      <td><strong>Supplier</strong></td>
      <td><strong>:</strong></td>
      <td><div id="supplier"></div></td>
      <td></td>
      <td><strong>Driver</strong></td>
      <td><strong>:</strong></td>
      <td><div id="driver"></div></td>
    </tr>
  </table>
  <br>
  Rincian:
  <br>
  <div id="dataTabel"></div>
  <hr>
  <div class="small">Dicetak dari sistem Timbangan</div>
  <script>window.print();</script>
</body>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const data = {{ data_print | tojson }};
  console.log(data);

  document.getElementById('tanggal').textContent = new Date().toLocaleDateString('id-ID');
  document.getElementById('supplier').textContent = data.supplier;
  document.getElementById('nopol').textContent = data.nopol;
  document.getElementById('driver').textContent = data.driver;

  const container = document.getElementById('dataTabel');
  container.innerHTML = "";  

  // START WRAPPER ROW
  let html = `<div style="display:flex; gap:16px; align-items:flex-start;">`;

  data.produk.forEach((itemProduk) => {
      const namaProduk = Object.keys(itemProduk)[0]; 
      const daftar = itemProduk[namaProduk];

      html += `
          <div style="flex:1;">
              <div style="font-weight:bold; margin-bottom:4px; text-align:center;">${namaProduk}</div>
              <table border="1" cellpadding="4" cellspacing="0" style="width:100%; font-size:11px;">
                  <tr style="font-weight:bold; background:#f2f2f2; text-align:center;">
                      <td>Kotor</td>
                      <td>Tare</td>
                      <td>Nett</td>
                  </tr>
      `;

      daftar.forEach(baris => {
          html += `
              <tr style="text-align:right;">
                  <td>${baris.berat_kotor}</td>
                  <td>${baris.berat_tare}</td>
                  <td>${baris.berat_nett}</td>
              </tr>
          `;
      });

      html += `
              </table>
          </div>
      `;
  });

  // CLOSE WRAPPER
  html += `</div>`;

  container.innerHTML = html;

</script>
</html>